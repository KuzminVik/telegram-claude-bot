# ๐ค Telegram ะฑะพั ั Claude AI + Weather + News + Mobile + RAG + Reranking

Telegram ะฑะพั ั Claude AI, ะฟะพะณะพะดะพะน, ะฝะพะฒะพัััะผะธ, ัะฟัะฐะฒะปะตะฝะธะตะผ Android ัะผัะปััะพัะพะผ ะธ RAG ะฟะพะธัะบะพะผ ั ัะผะฝะพะน ัะธะปัััะฐัะธะตะน ัะตัะตะท MCP ัะตัะฒะตัั.

[![Python](https://img.shields.io/badge/Python-3.12-blue.svg)](https://www.python.org/)
[![Telegram Bot API](https://img.shields.io/badge/Telegram%20Bot%20API-21.0-blue.svg)](https://python-telegram-bot.org/)
[![Claude AI](https://img.shields.io/badge/Claude-Sonnet%204-purple.svg)](https://www.anthropic.com/)
[![Node.js](https://img.shields.io/badge/Node.js-20.x-green.svg)](https://nodejs.org/)
[![Android](https://img.shields.io/badge/Android-API%2034-green.svg)](https://developer.android.com/)
[![Ollama](https://img.shields.io/badge/Ollama-nomic--embed--text-orange.svg)](https://ollama.ai/)

---

## ๐ฏ ะะพะทะผะพะถะฝะพััะธ

### ๐ฌ ะะฐะทะณะพะฒะพั ั Claude AI
- ะะพะดะดะตัะถะบะฐ ะธััะพัะธะธ ะดะธะฐะปะพะณะฐ (ะดะพ 30 ัะพะพะฑัะตะฝะธะน)
- ะะฒัะพะผะฐัะธัะตัะบะพะต ัะถะฐัะธะต ะธััะพัะธะธ ัะตัะตะท Claude
- ะะตััะธััะตะฝัะฝะพะต ััะฐะฝะตะฝะธะต ะฒ JSON (ัะพััะฐะฝัะตััั ะฟัะธ ะฟะตัะตะทะฐะฟััะบะต)
- ะะพะบะฐะท ััะฐัะธััะธะบะธ ัะพะบะตะฝะพะฒ

### ๐ค๏ธ ะะพะณะพะดะฐ (ัะตัะตะท MCP Weather Server)
- **ะขะตะบััะฐั ะฟะพะณะพะดะฐ** ะดะปั ะปัะฑะพะณะพ ะณะพัะพะดะฐ
- **ะัะพะณะฝะพะท ะฝะฐ ะดะตะฝั:** ะผะฐะบั/ะผะธะฝ ัะตะผะฟะตัะฐัััะฐ, ะพัะฐะดะบะธ, ะฒะพััะพะด/ะทะฐะบะฐั
- **ะกัะฐะฒะฝะตะฝะธะต ั ะฒัะตัะฐ:** Claude ะฐะฝะฐะปะธะทะธััะตั ะธะทะผะตะฝะตะฝะธั
- **ะฃััะตะฝะฝัั ัะฐัััะปะบะฐ** ะฒ 08:00 MSK ั ะดะฐะนะดะถะตััะพะผ

### ๐ฐ ะะพะฒะพััะธ (ัะตัะตะท MCP News Server)
- **RSS ะฝะพะฒะพััะธ** ะธะท ัะพััะธะนัะบะธั ะธััะพัะฝะธะบะพะฒ
- **3 ะบะฐัะตะณะพัะธะธ:** ะพะฑัะธะต, ัะตัะฝะพะปะพะณะธะธ, ะฑะธะทะฝะตั
- **ะขะพะฟ ะฝะพะฒะพััะธ** ะฒ ัััะตะฝะฝะตะน ัะฐัััะปะบะต
- **ะะพะผะฐะฝะดะฐ /morning_digest** - ะฟะพะณะพะดะฐ + ะฝะพะฒะพััะธ

### ๐ฑ Android ะญะผัะปััะพั (ัะตัะตะท MCP Mobile Server)
- **ะกะฟะธัะพะบ ััััะพะนััะฒ** - ะฟัะพัะผะพัั ะดะพัััะฟะฝัั ัะผัะปััะพัะพะฒ
- **ะะฐะฟััะบ ัะผัะปััะพัะฐ** - ะฐะฒัะพะผะฐัะธัะตัะบะธะน ััะฐัั ะตัะปะธ ะฒัะบะปััะตะฝ
- **ะกัะฐััั ะฟัะพะฒะตัะบะฐ** - ะณะพัะพะฒ ะปะธ ัะผัะปััะพั ะบ ัะฐะฑะพัะต
- **ะฃะดะฐะปัะฝะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต** - ัะตัะตะท SSH tunnel ั Mac ะฝะฐ ัะตัะฒะตั
- **ะะพะดะดะตัะถะบะฐ Appium** - ะณะพัะพะฒะฝะพััั ะดะปั UI ะฐะฒัะพะผะฐัะธะทะฐัะธะธ

### ๐ RAG ะะฐะทะฐ ะทะฝะฐะฝะธะน (ัะตัะตะท MCP Ollama Server)
- **ะะตะบัะพัะฝัะน ะฟะพะธัะบ** ะฟะพ ะดะพะบัะผะตะฝัะฐัะธะธ ะฑะพัะฐ
- **768-ะผะตัะฝัะต ัะผะฑะตะดะดะธะฝะณะธ** ัะตัะตะท nomic-embed-text
- **ะะฒัะพะผะฐัะธัะตัะบะธะน ะฒัะฑะพั** Claude ะธัะฟะพะปัะทัะตั ะฟัะธ ะฒะพะฟัะพัะฐั ะพ ะฑะพัะต
- **ะะพัะธะฝััะฝะพะต ััะพะดััะฒะพ** ะดะปั ัะฐะฝะถะธัะพะฒะฐะฝะธั ัะตะทัะปััะฐัะพะฒ

### ๐ฌ RAG ั ะฃะผะฝะพะน ะคะธะปัััะฐัะธะตะน โญ **ะะะะะ!**
- **ะะพะผะฐะฝะดะฐ /compare** - ััะฐะฒะฝะตะฝะธะต ะดะฒัั ัะตะถะธะผะพะฒ ัะธะปัััะฐัะธะธ
- **ะะตะณะบะธะน ัะธะปััั:** similarity โฅ 0.3, top-5 ะดะพะบัะผะตะฝัะพะฒ
- **ะะตััะบะธะน ัะธะปััั:** similarity โฅ 0.5, top-2 ะดะพะบัะผะตะฝัะฐ
- **ะะฐัะฐะปะปะตะปัะฝัะต ะทะฐะฟัะพัั** - ะฟะพะปััะตะฝะธะต ะพะฑะพะธั ะพัะฒะตัะพะฒ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
- **ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ:**
  - ะะพะปะธัะตััะฒะพ ะธัะฟะพะปัะทะพะฒะฐะฝะฝัั ะดะพะบัะผะตะฝัะพะฒ
  - ะกัะตะดะฝะธะน similarity score
  - ะะปะธะฝะฐ ะพัะฒะตัะพะฒ
- **ะกะพััะฐะฝะตะฝะธะต ัะตะทัะปััะฐัะพะฒ** ะฒ rag_comparisons.json ะดะปั ะฐะฝะฐะปะธะทะฐ
- **ะะฝะฐะปะธะท ัะฐะทะปะธัะธะน** ะผะตะถะดั ัะตะถะธะผะฐะผะธ ัะธะปัััะฐัะธะธ

### ๐ง ะะฝััััะผะตะฝัั Claude
- `get_weather(city)` - ะฟะพะปััะธัั ะฟะพะณะพะดั
- `get_news(category, limit)` - ะฟะพะปััะธัั ะฝะพะฒะพััะธ
- `mobile_list_available_devices()` - ัะฟะธัะพะบ Android ััััะพะนััะฒ
- `mobile_start_emulator()` - ะทะฐะฟัััะธัั ัะผัะปััะพั
- `search_knowledge(query, top_k)` - ะฟะพะธัะบ ะฒ ะฑะฐะทะต ะทะฝะฐะฝะธะน

---

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะะพะดัะปัะฝะฐั ััััะบัััะฐ (v9.0)

```
telegram-bot/
โโโ bot.py                      # ะขะพัะบะฐ ะฒัะพะดะฐ (140 ัััะพะบ)
โโโ config.py                   # ะะพะฝัะธะณััะฐัะธั (110 ัััะพะบ)
โโโ mcp_clients/                # MCP ะบะปะธะตะฝัั
โ   โโโ __init__.py
โ   โโโ weather_client.py      # Weather MCP
โ   โโโ news_client.py         # News MCP
โ   โโโ mobile_client.py       # Mobile MCP (SSH)
โ   โโโ ollama_client.py       # Ollama MCP ะดะปั RAG
โโโ handlers/                   # ะะฑัะฐะฑะพััะธะบะธ ะบะพะผะฐะฝะด
โ   โโโ __init__.py
โ   โโโ basic.py               # /start, /clear, /stats
โ   โโโ rag_compare.py         # /compare - RAG ัะธะปัััะฐัะธั
โโโ utils/                      # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ััะฝะบัะธะธ
    โโโ __init__.py
    โโโ helpers.py             # send_long_message
    โโโ rag_functions.py       # RAG ะปะพะณะธะบะฐ ั ัะธะปัััะฐัะธะตะน

ะัะตะณะพ: ~1000 ัััะพะบ ัะธััะพะณะพ ะผะพะดัะปัะฝะพะณะพ ะบะพะดะฐ
```

### ะกัะตะผะฐ ะฒะทะฐะธะผะพะดะตะนััะฒะธั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  Telegram Bot (Python) - ะกะตัะฒะตั                 โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ   Handlers   โ  โ APScheduler  โ  โ   4x MCP Clients     โ  โ
โ  โ              โ  โ              โ  โ                      โ  โ
โ  โ /compare     โ  โ  08:00 daily โ  โ Weather+News+       โ  โ
โ  โ /morning_    โ  โ  broadcast   โ  โ Mobile+Ollama        โ  โ
โ  โ  digest      โ  โ              โ  โ                      โ  โ
โ  โ /start_      โ  โ              โ  โ                      โ  โ
โ  โ  emulator    โ  โ              โ  โ                      โ  โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                              โ                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโ
        โ                   โ                  โ
        โ                   โ                  โ SSH Tunnel (localhost:2222)
โโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ MCP Weather   โ  โ  MCP News     โ  โ                          โ
โ  (Node.js)    โ  โ  (Node.js)    โ  โ  Mac (ะปะพะบะฐะปัะฝัะน)         โ
โ  Open-Meteo   โ  โ  RSS Feeds    โ  โ                          โ
โโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโ  โ  โโโโโโโโโโโโโโโโโโโโโ   โ
                                      โ  โ MCP Mobile        โ   โ
                                      โ  โ Appium+Emulator   โ   โ
                                      โ  โโโโโโโโโโโโโโโโโโโโโ   โ
                                      โ  โโโโโโโโโโโโโโโโโโโโโ   โ
                                      โ  โ MCP Ollama        โ   โ
                                      โ  โ RAG+Embeddings    โ   โ
                                      โ  โ Smart Filtering   โ   โ
                                      โ  โ (768D vectors)    โ   โ
                                      โ  โโโโโโโโโโโโโโโโโโโโโ   โ
                                      โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฑ ะะพะผะฐะฝะดั ะฑะพัะฐ

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั:
- `/start` - ะัะธะฒะตัััะฒะธะต ะธ ัะฟะธัะพะบ ะบะพะผะฐะฝะด
- `/clear` - ะัะธััะธัั ะธััะพัะธั ะดะธะฐะปะพะณะฐ
- `/stats` - ะะพะบะฐะทะฐัั ััะฐัะธััะธะบั (ัะพะพะฑัะตะฝะธั, ัะฐะทะผะตั ัะฐะนะปะฐ)
- `/debug` - ะะพะบะฐะทะฐัั ะฟะพัะปะตะดะฝะตะต ัะพะพะฑัะตะฝะธะต

### RAG ะกัะฐะฒะฝะตะฝะธะต ั ะคะธะปัััะฐัะธะตะน: โญ **ะะะะะ!**
- `/compare <ะฒะพะฟัะพั>` - ะกัะฐะฒะฝะธัั ะพัะฒะตัั ั ัะฐะทะฝัะผะธ ััะพะฒะฝัะผะธ ัะธะปัััะฐัะธะธ
  - **ะะตะณะบะธะน ัะธะปััั:** similarity โฅ 0.3, ะธัะฟะพะปัะทัะตั ะดะพ 5 ะดะพะบัะผะตะฝัะพะฒ
  - **ะะตััะบะธะน ัะธะปััั:** similarity โฅ 0.5, ะธัะฟะพะปัะทัะตั ะดะพ 2 ัะฐะผัั ัะตะปะตะฒะฐะฝัะฝัั ะดะพะบัะผะตะฝัะพะฒ
  - ะะพะบะฐะทัะฒะฐะตั ะพะฑะฐ ะพัะฒะตัะฐ ะฟะฐัะฐะปะปะตะปัะฝะพ
  - ะะตััะธะบะธ similarity ะธ ะบะพะปะธัะตััะฒะฐ ะดะพะบัะผะตะฝัะพะฒ
  - ะกะพััะฐะฝัะตั ัะตะทัะปััะฐัั ะดะปั ะฐะฝะฐะปะธะทะฐ

### ะะพะณะพะดะฐ:
- `/weather_subscribe ะะพัะพะด` - ะะพะดะฟะธัะฐัััั ะฝะฐ ัััะตะฝะฝัั ะฟะพะณะพะดั
- `/weather_unsubscribe` - ะัะฟะธัะฐัััั ะพั ะฟะพะณะพะดั
- `/weather_list` - ะะพะบะฐะทะฐัั ัะตะบัััั ะฟะพะดะฟะธัะบั

### ะะพะฒะพััะธ:
- `/morning_digest` - ะะพะปััะธัั ะดะฐะนะดะถะตัั (ะฟะพะณะพะดะฐ + ะฝะพะฒะพััะธ) ะฟััะผะพ ัะตะนัะฐั

### ะะพะฑะธะปัะฝัะต ััััะพะนััะฒะฐ:
- `/mobile_devices` - ะะพะบะฐะทะฐัั ะดะพัััะฟะฝัะต Android ััััะพะนััะฒะฐ
- `/start_emulator` - ะะฐะฟัััะธัั Android ัะผัะปััะพั

### ะกะปัะถะตะฑะฝัะต:
- `/test_morning` - ะัะพัะตััะธัะพะฒะฐัั ัััะตะฝะฝัั ัะฐัััะปะบั

---

## ๐ ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั RAG ะกัะฐะฒะฝะตะฝะธั

**ะะพะปัะทะพะฒะฐัะตะปั:** `/compare ะะฐะบะธะต ะบะพะผะฐะฝะดั ะตััั ั ะฑะพัะฐ?`

**ะะพั:**
```
๐ฌ ะกะะะะะะะะ ะะะะะะะ RERANKING

โ ะะพะฟัะพั: ะะฐะบะธะต ะบะพะผะฐะฝะดั ะตััั ั ะฑะพัะฐ?

โโโโโโโโโโโโโโโโโโโโ

๐ข ะะะะะะ ะคะะะฌะขะ (top-5 ะดะพะบัะผะตะฝัะพะฒ):

ะะพั ะธะผะตะตั ัะปะตะดัััะธะต ะบะพะผะฐะฝะดั: 
- /start - ะัะธะฒะตัััะฒะธะต ะธ ัะฟะธัะพะบ ะฒัะตั ะดะพัััะฟะฝัั ะบะพะผะฐะฝะด
- /clear - ะัะธััะธัั ะธััะพัะธั ะดะธะฐะปะพะณะฐ ั ะฑะพัะพะผ
- /stats - ะะพะบะฐะทะฐัั ััะฐัะธััะธะบั ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- /debug - ะะพะบะฐะทะฐัั ะฟะพัะปะตะดะฝะตะต ัะพะพะฑัะตะฝะธะต ะฒ ะธััะพัะธะธ ะดะปั ะพัะปะฐะดะบะธ

๐ ะััะพัะฝะธะบะธ (5 ะดะพะบัะผะตะฝัะพะฒ):
1. Similarity: 0.804
   "# Telegram ะฑะพั ั Claude AI - ะะพะบัะผะตะฝัะฐัะธั ะบะพะผะฐะฝะด..."
2. Similarity: 0.753
   "### ะะพะณะพะดะฐ ัะตัะตะท MCP Weather Server..."
3. Similarity: 0.750
   "## ะะพะฒะพััะธ: /morning_digest..."

โฑ๏ธ ะัะตะผั: 49.61ั | ะะพะดะตะปั: llama3.2:3b

โโโโโโโโโโโโโโโโโโโโ

๐ด ะะะกะขะะะ ะคะะะฌะขะ (top-2 ะดะพะบัะผะตะฝัะฐ):

ะะท ะฟัะตะดะพััะฐะฒะปะตะฝะฝะพะณะพ ะบะพะฝัะตะบััะฐ ะผะพะถะฝะพ ัะดะตะปะฐัั ะฒัะฒะพะด, ััะพ Telegram ะฑะพั 
ั Claude AI ะธะผะตะตั ัะปะตะดัััะธะต ะดะพัััะฟะฝัะต ะบะพะผะฐะฝะดั:
- /start - ะัะธะฒะตัััะฒะธะต ะธ ัะฟะธัะพะบ ะฒัะตั ะดะพัััะฟะฝัั ะบะพะผะฐะฝะด
- /clear - ะัะธััะธัั ะธััะพัะธั ะดะธะฐะปะพะณะฐ ั ะฑะพัะพะผ
- /stats - ะะพะบะฐะทะฐัั ััะฐัะธััะธะบั ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- /debug - ะะพะบะฐะทะฐัั ะฟะพัะปะตะดะฝะตะต ัะพะพะฑัะตะฝะธะต ะฒ ะธััะพัะธะธ ะดะปั ะพัะปะฐะดะบะธ

๐ ะััะพัะฝะธะบะธ (2 ะดะพะบัะผะตะฝัะพะฒ):
1. Similarity: 0.804
   "# Telegram ะฑะพั ั Claude AI - ะะพะบัะผะตะฝัะฐัะธั ะบะพะผะฐะฝะด..."
2. Similarity: 0.753
   "### ะะพะณะพะดะฐ ัะตัะตะท MCP Weather Server..."

โฑ๏ธ ะัะตะผั: 63.25ั | ะะพะดะตะปั: llama3.2:3b

โโโโโโโโโโโโโโโโโโโโ

๐ ะะะะะะ ะะะะะะงะะ:
โข ะะพะบัะผะตะฝัะพะฒ: 5 vs 2 (ัะฐะทะฝะธัะฐ: 3)
โข ะกัะตะดะฝะธะน similarity (ะปะตะณะบะธะน): 0.769
โข ะกัะตะดะฝะธะน similarity (ะถะตััะบะธะน): 0.779
โข ะะปะธะฝะฐ ะพัะฒะตัะฐ: 282 vs 374 ัะธะผะฒะพะปะพะฒ
```

**ะัะฒะพะดั:**
- ะะตะณะบะธะน ัะธะปััั ะดะฐะตั ะบัะฐัะบะธะน ะพัะฒะตั ั ะฑะพะปััะธะผ ะบะพะฝัะตะบััะพะผ
- ะะตััะบะธะน ัะธะปััั ะณะตะฝะตัะธััะตั ะฑะพะปะตะต ัะฐะทะฒะตัะฝัััะน ะพัะฒะตั, ัะพะบััะธััััั ะฝะฐ ัะพะฟ-2 ะธััะพัะฝะธะบะฐั
- ะะฑะฐ ะฝะฐัะพะดัั ัะตะปะตะฒะฐะฝัะฝัั ะธะฝัะพัะผะฐัะธั (similarity > 0.75)
- ะะตััะบะธะน ัะธะปััั ะธะผะตะตั ะฒััะต ััะตะดะฝะธะน similarity (0.779 vs 0.769)

---

## ๐ฆ ะฃััะฐะฝะพะฒะบะฐ

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

**ะะฐ ัะตัะฒะตัะต (Ubuntu):**
- Python 3.12+
- Node.js 20.x
- systemd ะดะปั ะฐะฒัะพะทะฐะฟััะบะฐ

**ะะฐ Mac (ะดะปั MCP ัะตัะฒะตัะพะฒ):**
- Node.js 20.x
- Ollama ั ะผะพะดะตะปัะผะธ `nomic-embed-text` ะธ `llama3.2:3b`
- Android Studio + SDK (ะดะปั mobile-mcp)
- Appium (ะดะปั mobile-mcp)

### ะงะฐััั 1: ะกะตัะฒะตั (Python Bot + MCP Weather/News)

#### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

```bash
git clone https://github.com/KuzminVik/telegram-claude-bot.git
cd telegram-claude-bot
```

#### 2. ะฃััะฐะฝะพะฒะบะฐ Python ะทะฐะฒะธัะธะผะพััะตะน

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

**requirements.txt:**
```
python-telegram-bot==21.0
anthropic==0.75.0
apscheduler==3.10.4
```

#### 3. ะฃััะฐะฝะพะฒะบะฐ MCP Weather Server

```bash
cd /home/claude/mcp-weather-server
npm install
npm test  # ะัะพะฒะตัะบะฐ ัะฐะฑะพัั
```

#### 4. ะฃััะฐะฝะพะฒะบะฐ MCP News Server

```bash
cd /home/claude/mcp-news-server
npm install
npm test  # ะัะพะฒะตัะบะฐ ัะฐะฑะพัั
```

#### 5. ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั

```bash
export TELEGRAM_BOT_TOKEN="your_telegram_bot_token"
export ANTHROPIC_API_KEY="your_anthropic_api_key"
```

---

### ะงะฐััั 2: Mac (MCP Mobile + Ollama + RAG)

#### 1. ะฃััะฐะฝะพะฒะบะฐ Ollama

```bash
# ะฃััะฐะฝะพะฒะธัะต Ollama ั https://ollama.ai
brew install ollama

# ะกะบะฐัะฐะนัะต ะฝะตะพะฑัะพะดะธะผัะต ะผะพะดะตะปะธ
ollama pull nomic-embed-text  # ะะปั ัะผะฑะตะดะดะธะฝะณะพะฒ (768 ะธะทะผะตัะตะฝะธะน)
ollama pull llama3.2:3b        # ะะปั ะณะตะฝะตัะฐัะธะธ ะพัะฒะตัะพะฒ
```

#### 2. ะฃััะฐะฝะพะฒะบะฐ MCP Ollama Server

```bash
cd ~/mcp-servers
git clone <your-ollama-mcp-repo>
cd ollama-mcp
npm install
```

#### 3. ะกะพะทะดะฐะฝะธะต ะฟะพััะพัะฝะฝะพะน ะดะธัะตะบัะพัะธะธ ะดะปั vector stores

```bash
# ะกะพะทะดะฐะตะผ ะฟะพััะพัะฝะฝัั ะดะธัะตะบัะพัะธั (ะฝะต ะฒ /tmp)
mkdir -p ~/vector_stores

# ะะพะฑะฐะฒะปัะตะผ ะฒ ~/.zshrc ะดะปั ะฟะพััะพัะฝััะฒะฐ
echo 'export VECTOR_STORE_DIR=~/vector_stores' >> ~/.zshrc
source ~/.zshrc
```

#### 4. ะกะพะทะดะฐะฝะธะต ะฑะฐะทั ะทะฝะฐะฝะธะน ะฑะพัะฐ

```bash
cd ~/mcp-servers/ollama-mcp

# ะะฐะฟัััะธัะต ัะบัะธะฟั ัะพะทะดะฐะฝะธั vector store
VECTOR_STORE_DIR=~/vector_stores node create_vector_store_v2.js

# ะัะพะฒะตัััะต ััะพ ะฑะฐะทะฐ ัะพะทะดะฐะปะฐัั
ls -lh ~/vector_stores/bot_knowledge.json
```

#### 5. ะฃััะฐะฝะพะฒะบะฐ Android Studio + Mobile MCP (ะพะฟัะธะพะฝะฐะปัะฝะพ)

ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ ะธะท ะฟัะตะดัะดััะตะน ะฒะตััะธะธ README ะดะปั ะฝะฐัััะพะนะบะธ Android ัะผัะปััะพัะฐ ะธ Appium.

#### 6. ะะฐัััะพะนะบะฐ SSH Tunnel

ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ ะธะท ะฟัะตะดัะดััะตะน ะฒะตััะธะธ README ะดะปั ะฝะฐัััะพะนะบะธ Reverse SSH tunnel.

---

### ะงะฐััั 3: ะะฐะฟััะบ ะฑะพัะฐ ะฝะฐ ัะตัะฒะตัะต

#### 1. ะะฑะฝะพะฒะปะตะฝะธะต config.py

ะฃะฑะตะดะธัะตัั ััะพ ะฒ `config.py` ะฟัะฐะฒะธะปัะฝะพ ัะบะฐะทะฐะฝั ะฟััะธ:

```python
# MCP Ollama Server (ัะตัะตะท SSH)
MCP_OLLAMA_SSH_HOST = "localhost"
MCP_OLLAMA_SSH_PORT = 2222
MCP_OLLAMA_SSH_USER = "YOUR_MAC_USER"
MCP_OLLAMA_SSH_KEY = "/root/.ssh/server_to_mac"
MCP_OLLAMA_NODE_PATH = "/Users/YOUR_MAC_USER/.nvm/versions/node/v20.19.6/bin/node"
MCP_OLLAMA_SERVER_PATH = "/Users/YOUR_MAC_USER/mcp-servers/ollama-mcp/server.js"

# RAG ะฝะฐัััะพะนะบะธ
RAG_VECTOR_STORE_NAME = "bot_knowledge"
RAG_TOP_K_INITIAL = 10  # ะะพะปะธัะตััะฒะพ ัะฐะฝะบะพะฒ ะดะปั ะฟะตัะฒะธัะฝะพะณะพ ะฟะพะธัะบะฐ
RAG_LLM_MODEL = "llama3.2:3b"
```

#### 2. ะกะพะทะดะฐะฝะธะต systemd ัะตัะฒะธัะฐ

```bash
sudo nano /etc/systemd/system/telegram-bot.service
```

```ini
[Unit]
Description=Telegram Claude Bot
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/telegram-bot
Environment="TELEGRAM_BOT_TOKEN=your_token"
Environment="ANTHROPIC_API_KEY=your_key"
ExecStart=/root/telegram-bot/venv/bin/python /root/telegram-bot/bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### 3. ะะฐะฟััะบ

```bash
sudo systemctl daemon-reload
sudo systemctl enable telegram-bot
sudo systemctl start telegram-bot
sudo systemctl status telegram-bot
```

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### 1. ะขะตัั RAG ั ัะธะปัััะฐัะธะตะน

```bash
# ะ Telegram ะฑะพัะต
/compare ะะฐะบะธะต ะบะพะผะฐะฝะดั ะตััั ั ะฑะพัะฐ?
/compare ะะฐะบ ัะฐะฑะพัะฐะตั ะฟะพะณะพะดะฐ?
/compare ะงัะพ ัะผะตะตั ะดะตะปะฐัั ัะผัะปััะพั?
```

### 2. ะขะตัั vector store ะฝะฐ Mac

```bash
# ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั
ls -lh ~/vector_stores/bot_knowledge.json

# ะัะพะฒะตัะบะฐ ัะตัะตะท Ollama MCP
cd ~/mcp-servers/ollama-mcp
VECTOR_STORE_DIR=~/vector_stores node -e "
import('./server.js');
" &

# ะขะตัั ะฟะพะธัะบะฐ (ะฒ ะพัะดะตะปัะฝะพะผ ัะตัะผะธะฝะฐะปะต)
echo '{"jsonrpc":"2.0","method":"tools/call","params":{"name":"vector_store_search","arguments":{"store_name":"bot_knowledge","query":"ะบะพะผะฐะฝะดั ะฑะพัะฐ","top_k":3}},"id":1}' | nc localhost 3000
```

---

## ๐ง ะะฐะบ ัะฐะฑะพัะฐะตั ัะธะปัััะฐัะธั

### ะะปะณะพัะธัะผ ัะฐะฑะพัั `/compare`:

1. **ะกะพะทะดะฐะฝะธะต ัะผะฑะตะดะดะธะฝะณะฐ ะทะฐะฟัะพัะฐ** ัะตัะตะท `nomic-embed-text`
2. **ะะพะธัะบ ะฟะพัะพะถะธั ัะฐะฝะบะพะฒ** ะฟะพ cosine similarity (ัะพะฟ-10)
3. **ะคะธะปัััะฐัะธั ะฟะพ ัะตะถะธะผั:**
   - **ะะตะณะบะธะน:** ะฑะตัะตะผ ัะฐะฝะบะธ ั similarity โฅ 0.3, ะผะฐะบัะธะผัะผ 5 ัััะบ
   - **ะะตััะบะธะน:** ะฑะตัะตะผ ัะฐะฝะบะธ ั similarity โฅ 0.5, ะผะฐะบัะธะผัะผ 2 ัััะบะธ
4. **ะะตะฝะตัะฐัะธั ะพัะฒะตัะฐ** ัะตัะตะท `llama3.2:3b` ั ะพััะธะปัััะพะฒะฐะฝะฝัะผ ะบะพะฝัะตะบััะพะผ
5. **ะะฐัะฐะปะปะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต** ะดะฒัั ะทะฐะฟัะพัะพะฒ ะดะปั ััะฐะฒะฝะตะฝะธั
6. **ะะฝะฐะปะธะท ัะฐะทะปะธัะธะน** ะธ ะฒัะฒะพะด ะผะตััะธะบ

### ะัะตะธะผััะตััะฒะฐ ะฟะพะดัะพะดะฐ:

โ **ะัะพััะพัะฐ** - ะฝะต ััะตะฑัะตั ML ะผะพะดะตะปะตะน ะดะปั reranking  
โ **ะกะบะพัะพััั** - ัะธะปัััะฐัะธั ะฟะพ ะฟะพัะพะณั ะพัะตะฝั ะฑััััะฐั  
โ **ะะธะฑะบะพััั** - ะปะตะณะบะพ ะฝะฐัััะพะธัั ะฟะพัะพะณะธ ะฟะพะด ะบะพะฝะบัะตัะฝัะต ะทะฐะดะฐัะธ  
โ **ะัะพะทัะฐัะฝะพััั** - ะฒะธะดะฝั ะฒัะต similarity scores  
โ **ะญััะตะบัะธะฒะฝะพััั** - ะผะตะฝััะต ะดะพะบัะผะตะฝัะพะฒ = ะฑััััะตะต ะณะตะฝะตัะฐัะธั  

---

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### SSH ะขัะฝะฝะตะปะธ
- โ Reverse SSH tunnel ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะฟะตัะตะฟะพะดะบะปััะตะฝะธะตะผ
- โ SSH ะบะปััะธ ะฑะตะท passphrase ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ
- โ ServerAliveInterval ะดะปั ะฟะพะดะดะตัะถะฐะฝะธั ัะพะตะดะธะฝะตะฝะธั
- โ LaunchAgent ะดะปั ะฐะฒัะพะทะฐะฟััะบะฐ ะฟัะธ ะทะฐะณััะทะบะต Mac

### ะะทะพะปััะธั ะฟัะพัะตััะพะฒ
- โ ะะฐะถะดัะน MCP - ะพัะดะตะปัะฝัะน ะฟัะพัะตัั
- โ Ollama ะธะทะพะปะธัะพะฒะฐะฝ ะฝะฐ Mac
- โ Vector stores ะฒ ะฟะพััะพัะฝะฝะพะน ะดะธัะตะบัะพัะธะธ
- โ Timeout ะดะปั ะฒัะตั SSH ะบะพะผะฐะฝะด

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
- โ VECTOR_STORE_DIR ะฟะตัะตะดะฐะตััั ัะตัะตะท SSH
- โ PATH ะฝะฐัััะพะตะฝ ะดะปั non-interactive ัะตััะธะน
- โ ะะพะปะฝัะต ะฟััะธ ะบ node ะธ ะดััะณะธะผ ะฑะธะฝะฐัะฝะธะบะฐะผ

---

## ๐ ะกัะฐััั ะฟัะพะตะบัะฐ

**ะขะตะบััะฐั ะฒะตััะธั:** 9.0.0 (RAG with Smart Filtering)

**ะะพัะปะตะดะฝะธะต ะธะทะผะตะฝะตะฝะธั (24.12.2024):**
- โ **ะฃะผะฝะฐั ัะธะปัััะฐัะธั RAG** - ะดะฒะฐ ัะตะถะธะผะฐ ัะธะปัััะฐัะธะธ ะฟะพ similarity
- โ **ะะพะผะฐะฝะดะฐ /compare** - ััะฐะฒะฝะตะฝะธะต ะปะตะณะบะพะณะพ ะธ ะถะตััะบะพะณะพ ัะธะปัััะพะฒ
- โ **ะะฑะฝะพะฒะปะตะฝะฝัะต ะผะตััะธะบะธ** - ะฟะพะบะฐะท similarity scores ะฒะผะตััะพ rerank scores
- โ **ะะพััะพัะฝะฝะพะต ััะฐะฝะธะปะธัะต** - vector store ะฒ ~/vector_stores ะฒะผะตััะพ /tmp
- โ **ะฃะปัััะตะฝะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั** - ะฟะพะปะฝะพะต ะพะฟะธัะฐะฝะธะต ัะธะปัััะฐัะธะธ

**ะัะตะดัะดััะธะต ะฒะตััะธะธ:**
- 8.0.0 (24.12.2024) - ะะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ + RAG Comparison
- 7.0.0 (23.12.2024) - Ollama RAG Integration ั ะฒะตะบัะพัะฝัะผ ะฟะพะธัะบะพะผ
- 6.0.0 (21.12.2024) - MCP Mobile + Appium + Android ัะผัะปััะพั
- 5.0.0 (19.12.2024) - MCP News + ัััะตะฝะฝะธะต ะดะฐะนะดะถะตััั
- 4.0.0 (17.12.2024) - ะะพะณะพะดะฝัะต ะฟะพะดะฟะธัะบะธ + ััะฐะฒะฝะตะฝะธะต ั ะฒัะตัะฐ

**ะ ัะฐะทัะฐะฑะพัะบะต:**
- [ ] ML-based reranker (ะบะพะณะดะฐ ะฑัะดะตั ััะฐะฑะธะปัะฝะฐั ะฑะธะฑะปะธะพัะตะบะฐ)
- [ ] ะะดะฐะฟัะธะฒะฝัะน ะฒัะฑะพั ัะตะถะธะผะฐ ัะธะปัััะฐัะธะธ
- [ ] ะะฐััะธัะตะฝะธะต ะฑะฐะทั ะทะฝะฐะฝะธะน
- [ ] ะะพะดะดะตัะถะบะฐ PDF/DOCX ะดะพะบัะผะตะฝัะพะฒ ะฒ RAG

---

## ๐ง ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผะฐ: Vector store ะฝะต ะฝะฐะนะดะตะฝ

**ะะตัะตะฝะธะต:**
```bash
# ะะฐ Mac ะฟัะพะฒะตัััะต ะฝะฐะปะธัะธะต
ls -lh ~/vector_stores/bot_knowledge.json

# ะะตัะตัะพะทะดะฐะนัะต ะตัะปะธ ะฝัะถะฝะพ
cd ~/mcp-servers/ollama-mcp
VECTOR_STORE_DIR=~/vector_stores node create_vector_store_v2.js
```

### ะัะพะฑะปะตะผะฐ: ะััััะต ะพัะฒะตัั ะพั RAG

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัััะต ะปะพะณะธ ะฝะฐ ัะตัะฒะตัะต
journalctl -u telegram-bot -n 100 | grep "MCP Ollama"

# ะัะพะฒะตัััะต ััะพ VECTOR_STORE_DIR ะฟะตัะตะดะฐะตััั
# ะ ollama_client.py ะดะพะปะถะฝะฐ ะฑััั ัััะพะบะฐ:
# f'VECTOR_STORE_DIR=/Users/{self.ssh_user}/vector_stores {self.node_path} {self.server_path}'
```

### ะัะพะฑะปะตะผะฐ: ะะธะทะบะธะต similarity scores

**ะะตัะตะฝะธะต:**
```bash
# ะะฑะฝะพะฒะธัะต ะฑะฐะทั ะทะฝะฐะฝะธะน ะฑะพะปะตะต ะดะตัะฐะปัะฝะพะน ะดะพะบัะผะตะฝัะฐัะธะตะน
# ะะปะธ ะฟะพะฝะธะทััะต ะฟะพัะพะณะธ ะฒ server.js:
# const threshold = rerank_mode === 'strict' ? 0.4 : 0.2;
```

---

## ๐ค ะะบะปะฐะด

ะัะพะตะบั ะพัะบััั ะดะปั ัะปัััะตะฝะธะน! ะัะปะธ ั ะฒะฐั ะตััั ะธะดะตะธ ะธะปะธ ะฝะฐัะปะธ ะฑะฐะณ:

1. ะกะพะทะดะฐะนัะต Issue
2. ะคะพัะบะฝะธัะต ัะตะฟะพะทะธัะพัะธะน
3. ะกะพะทะดะฐะนัะต ะฒะตัะบั ะดะปั ัะธัะธ
4. ะัะฟัะฐะฒััะต Pull Request

---

## ๐ ะะธัะตะฝะทะธั

MIT License

---

## ๐จโ๐ป ะะฒัะพั

**ะะธะบัะพั ะัะทัะผะธะฝ**
- GitHub: [@KuzminVik](https://github.com/KuzminVik)
- Telegram ะฑะพั: ัะพะทะดะฐะฝ ั ะฟะพะผะพััั Claude AI (Anthropic)

---

## ๐ ะะปะฐะณะพะดะฐัะฝะพััะธ

- [Anthropic](https://www.anthropic.com/) - Claude AI
- [python-telegram-bot](https://python-telegram-bot.org/) - Telegram Bot ะฑะธะฑะปะธะพัะตะบะฐ
- [Open-Meteo](https://open-meteo.com/) - Weather API
- [MCP](https://modelcontextprotocol.io/) - Model Context Protocol
- [mobile-mcp](https://github.com/mobile-next/mobile-mcp) - MCP Mobile Server
- [Appium](https://appium.io/) - ะผะพะฑะธะปัะฝะฐั ะฐะฒัะพะผะฐัะธะทะฐัะธั
- [Ollama](https://ollama.ai/) - ะปะพะบะฐะปัะฝะฐั LLM ะฟะปะฐััะพัะผะฐ

---

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- [MODULAR_ARCHITECTURE_SUMMARY.md](./MODULAR_ARCHITECTURE_SUMMARY_2024-12-24.md) - ะะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ v9.0
- [OLLAMA_RAG_INTEGRATION_SUMMARY.md](./OLLAMA_RAG_INTEGRATION_SUMMARY.md) - ะะฝัะตะณัะฐัะธั RAG ะฟะพะธัะบะฐ
- [MOBILE_INTEGRATION_SUMMARY.md](./MOBILE_INTEGRATION_SUMMARY.md) - ะะฝัะตะณัะฐัะธั Android ัะผัะปััะพัะฐ
- [NEWS_MCP_INTEGRATION_SUMMARY.md](./NEWS_MCP_INTEGRATION_SUMMARY.md) - ะะฝัะตะณัะฐัะธั ะฝะพะฒะพััะตะน
- [PROJECT_CONTEXT_UPDATED.md](./PROJECT_CONTEXT_UPDATED.md) - ะะพะปะฝัะน ะบะพะฝัะตะบัั ะฟัะพะตะบัะฐ

---

**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 24 ะดะตะบะฐะฑัั 2024  
**ะะตััะธั README:** 9.0.0
