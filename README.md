# ü§ñ Telegram Claude Bot

Telegram –±–æ—Ç —Å Claude AI, MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏, RAG –ø–æ–∏—Å–∫–æ–º –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM.

**–í–µ—Ä—Å–∏—è:** v14.0 (Local LLM Mode)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã
- **‚òÅÔ∏è Claude Sonnet 4.5** - –≥–ª–∞–≤–Ω—ã–π AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç (—á–µ—Ä–µ–∑ API)
- **ü§ñ –õ–æ–∫–∞–ª—å–Ω–∞—è LLM** - llama3.2:3b —á–µ—Ä–µ–∑ Ollama –Ω–∞ Mac (–Ω–æ–≤–æ–µ!)
- **üß† RAG –ø–æ–∏—Å–∫** - –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º

### MCP –°–µ—Ä–≤–µ—Ä—ã
- **üå§Ô∏è Weather** - –ø–æ–≥–æ–¥–∞ –¥–ª—è –ª—é–±–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- **üì∞ News** - —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ (RSS)
- **üì± Mobile** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Android —ç–º—É–ª—è—Ç–æ—Ä–æ–º
- **üêô GitHub** - –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- **üìã Tasks** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∫–æ–º–∞–Ω–¥—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- **üîî Code Review** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–≤—å—é PR —á–µ—Ä–µ–∑ webhooks
- **üéß Support** - —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å RAG –∏ —Ç–∏–∫–µ—Ç–∞–º–∏
- **üë• Team Assistant** - —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Å –∞–Ω–∞–ª–∏–∑–æ–º –∑–∞–¥–∞—á

---

## üì± –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã
```
/mode                  - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
/mode claude          - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ Claude API
/mode local           - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é LLM
/clear                - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é Claude
/clear_local          - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ª–æ–∫–∞–ª—å–Ω–æ–π LLM
```

### RAG –∏ –ø–æ–∏—Å–∫
```
/with_rag <–≤–æ–ø—Ä–æ—Å>    - –∑–∞–ø—Ä–æ—Å —Å RAG –ø–æ–∏—Å–∫–æ–º
/search_repo <–∑–∞–ø—Ä–æ—Å> - –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É GitHub
/get_file <–ø—É—Ç—å>      - –ø–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª –∏–∑ —Ä–µ–ø–æ
```

### –ü–æ–≥–æ–¥–∞ –∏ –Ω–æ–≤–æ—Å—Ç–∏
```
/weather_subscribe <–≥–æ—Ä–æ–¥>  - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É—Ç—Ä–µ–Ω–Ω—é—é –ø–æ–≥–æ–¥—É (08:00 MSK)
/weather_unsubscribe        - –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è
/morning_digest             - –ø–æ–≥–æ–¥–∞ + –Ω–æ–≤–æ—Å—Ç–∏ —Å–µ–π—á–∞—Å
```

### –ó–∞–¥–∞—á–∏ –∏ –∫–æ–º–∞–Ω–¥–∞
```
/tasks [—Ñ–∏–ª—å—Ç—Ä]       - —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
/task_create <priority> <–Ω–∞–∑–≤–∞–Ω–∏–µ>
/task_update <id> <–ø–æ–ª–µ> <–∑–Ω–∞—á–µ–Ω–∏–µ>
/ask_team <–≤–æ–ø—Ä–æ—Å>    - —É–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–¥–∞—á —Å RAG
```

### –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞
```
/support <–≤–æ–ø—Ä–æ—Å>     - –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ–¥–¥–µ—Ä–∂–∫–µ
/my_tickets           - –º–æ–∏ —Ç–∏–∫–µ—Ç—ã
```

### Android —ç–º—É–ª—è—Ç–æ—Ä
```
/mobile_devices       - —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
/start_emulator       - –∑–∞–ø—É—Å—Ç–∏—Ç—å Pixel 8 API 34
```

---

## ü§ñ Local Mode (llama3.2:3b)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –õ–æ–∫–∞–ª—å–Ω–∞—è LLM –∑–∞–ø—É—â–µ–Ω–∞ –Ω–∞ Mac —á–µ—Ä–µ–∑ Ollama
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å (–ø–æ—Ä—Ç 11435)
- –û—Ç–¥–µ–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- –ú–æ–¥–µ–ª—å: llama3.2:3b (2GB RAM, ~1024 tokens)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/mode local
–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ
‚Üí –û—Ç–≤–µ—Ç–∏—Ç llama3.2:3b

/mode claude
–ü—Ä–∏–≤–µ—Ç Claude
‚Üí –û—Ç–≤–µ—Ç–∏—Ç Claude Sonnet 4.5
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–∫—Ä–æ–º–µ SSH)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–Ω–µ—Ç API costs)
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ Claude (~5-10 —Å–µ–∫)
- ‚ö†Ô∏è –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (20 —Å–æ–æ–±—â–µ–Ω–∏–π)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Telegram User
    ‚Üì
Telegram Bot (Python)
    ‚îú‚îÄ‚îÄ Claude API (—Ä–µ–∂–∏–º claude)
    ‚îú‚îÄ‚îÄ Ollama LLM (—Ä–µ–∂–∏–º local) ‚Üê —á–µ—Ä–µ–∑ SSH –Ω–∞ Mac
    ‚îú‚îÄ‚îÄ RAG (Ollama + nomic-embed-text)
    ‚îú‚îÄ‚îÄ MCP Servers (Weather, News, GitHub, Tasks, Mobile)
    ‚îî‚îÄ‚îÄ CRM (users.json, tickets.json)
```

### –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
/root/telegram-bot/
‚îú‚îÄ‚îÄ bot.py                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config.py                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ handlers/                   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ basic.py               # –û—Å–Ω–æ–≤–Ω—ã–µ + handle_message (—Å —Ä–µ–∂–∏–º–∞–º–∏)
‚îÇ   ‚îú‚îÄ‚îÄ local_mode.py          # –ö–æ–º–∞–Ω–¥—ã /mode, /clear_local
‚îÇ   ‚îú‚îÄ‚îÄ with_rag.py            # RAG –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ support.py             # –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ team_assistant.py      # –ö–æ–º–∞–Ω–¥–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ pr_review.py           # Code review
‚îú‚îÄ‚îÄ mcp_clients/                # MCP –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ollama_chat_client.py  # Ollama –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π LLM
‚îÇ   ‚îú‚îÄ‚îÄ weather_client.py
‚îÇ   ‚îú‚îÄ‚îÄ news_client.py
‚îÇ   ‚îú‚îÄ‚îÄ mobile_client.py
‚îÇ   ‚îú‚îÄ‚îÄ ollama_client.py       # Ollama RAG
‚îÇ   ‚îú‚îÄ‚îÄ github_client.py
‚îÇ   ‚îî‚îÄ‚îÄ task_client.py
‚îú‚îÄ‚îÄ utils/                      # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conversation_manager.py # –†–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ rag_functions.py
‚îÇ   ‚îú‚îÄ‚îÄ crm_functions.py
‚îÇ   ‚îî‚îÄ‚îÄ github_api.py
‚îú‚îÄ‚îÄ conversations/              # –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ user_{id}.json         # Claude —Ä–µ–∂–∏–º
‚îÇ   ‚îú‚îÄ‚îÄ local_{id}.json        # Local —Ä–µ–∂–∏–º
‚îÇ   ‚îî‚îÄ‚îÄ user_modes.json        # –¢–µ–∫—É—â–∏–µ —Ä–µ–∂–∏–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ crm_data/                  # CRM –¥–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ users.json
    ‚îî‚îÄ‚îÄ tickets.json
```

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.12+
- Node.js 20+ (–¥–ª—è MCP —Å–µ—Ä–≤–µ—Ä–æ–≤)
- Ollama (–¥–ª—è RAG –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM)
- SSH –¥–æ—Å—Ç—É–ø –∫ Mac (–¥–ª—è Mobile –∏ Ollama MCP)

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ
git clone https://github.com/KuzminVik/telegram-claude-bot
cd telegram-claude-bot

# 2. –°–æ–∑–¥–∞—Ç—å venv –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export TELEGRAM_BOT_TOKEN="your_token"
export ANTHROPIC_API_KEY="your_api_key"
export GITHUB_TOKEN="your_github_token"

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å
python bot.py
```

### Systemd service
```bash
sudo cp telegram-bot.service /etc/systemd/system/
sudo systemctl enable telegram-bot
sudo systemctl start telegram-bot
sudo journalctl -u telegram-bot -f
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Local Mode Setup

**–ù–∞ Mac (–≥–¥–µ –∑–∞–ø—É—â–µ–Ω Ollama):**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Ollama
brew install ollama

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Ollama
ollama serve

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å
ollama pull llama3.2:3b
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≥–¥–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç):**
```bash
# –°–æ–∑–¥–∞—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞)
ssh -i ~/.ssh/server_to_mac -L 11435:localhost:11434 -N -p 2222 user@mac &

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
curl http://localhost:11435/api/tags
```

**–í –∫–æ–¥–µ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ):**
- `mcp_clients/ollama_chat_client.py` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è Ollama
- `handlers/local_mode.py` - –∫–æ–º–∞–Ω–¥—ã —Ä–µ–∂–∏–º–æ–≤
- `handlers/basic.py` - handle_message –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Ä–µ–∂–∏–º–∞

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–í–µ—Ä—Å–∏—è:** v14.0
- **–ö–æ–º–º–∏—Ç–æ–≤:** 100+
- **–§–∞–π–ª–æ–≤ Python:** 25+
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~8000
- **MCP —Å–µ—Ä–≤–µ—Ä–æ–≤:** 6
- **–ö–æ–º–∞–Ω–¥ –±–æ—Ç–∞:** 30+

---

## üîó –°—Å—ã–ª–∫–∏

- **GitHub:** https://github.com/KuzminVik/telegram-claude-bot
- **Anthropic API:** https://docs.anthropic.com
- **MCP Protocol:** https://github.com/anthropics/mcp
- **Ollama:** https://ollama.ai

---

## üìù Changelog

### v14.0 (20.01.2026) - Local LLM Mode
- ‚ú® –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–∂–∏–º –ª–æ–∫–∞–ª—å–Ω–æ–π LLM (llama3.2:3b)
- ‚ú® –ö–æ–º–∞–Ω–¥—ã `/mode`, `/clear_local`
- ‚ú® –û—Ç–¥–µ–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- ‚ú® SSH —Ç—É–Ω–Ω–µ–ª—å –∫ Ollama –Ω–∞ Mac
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ bot.py
- üì¶ –î–æ–±–∞–≤–ª–µ–Ω `utils/conversation_manager.py`

### v13.0 (18.01.2026) - CI/CD
- Docker –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions
- Private Docker Registry
- Zero-downtime deployment

### v12.0 (15.01.2026) - Team Assistant
- Task MCP Server
- –ö–æ–º–∞–Ω–¥–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å RAG + Tasks

### v11.0 (14.01.2026) - Support System
- CRM –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–∏–∫–µ—Ç–æ–≤
- RAG –¥–ª—è FAQ (90+ –≤–æ–ø—Ä–æ—Å–æ–≤)

### v10.0 (14.01.2026) - Code Review
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–≤—å—é PR
- GitHub Webhooks
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

**–ê–≤—Ç–æ—Ä:** –í–∏–∫—Ç–æ—Ä –ö—É–∑—å–º–∏–Ω  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
